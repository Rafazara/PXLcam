; PXLcam Firmware v1.2.0
; ESP32-CAM Pixel Art Camera
; Architecture: Modular with State Machine

[env:esp32cam]
platform = espressif32
board = esp32cam
framework = arduino

upload_speed = 921600
monitor_speed = 115200

monitor_filters = direct
monitor_dtr = 0
monitor_rts = 0

build_flags =
    -DPXLCAM_VERSION=\"1.2.0\"
    -DCORE_DEBUG_LEVEL=0
    -DBOARD_HAS_PSRAM
    -mfix-esp32-psram-cache-issue
    -Os
    -std=gnu++17

build_unflags = -std=gnu++11

lib_deps =
    adafruit/Adafruit GFX Library @ ^1.11.9
    adafruit/Adafruit SSD1306 @ ^2.5.9
    espressif/esp32-camera @ ^2.0.4

; Self-test mode (uncomment to enable)
; Add -DPXLCAM_SELFTEST to build_flags

; ============================================================================
; Test Environment Options
; ============================================================================

; Option 1: Native (requires gcc/g++ installed)
; Run: pio test -e test_native
[env:test_native]
platform = native
build_flags = 
    -std=gnu++17
    -DPXLCAM_TESTING
    -DPXLCAM_VERSION=\"1.2.0\"
test_framework = unity
test_filter = test_v1_2
test_build_src = false

; Option 2: ESP32 Build-only (for CI/build verification)
; Run: pio test -e test_esp32 --without-uploading --without-testing
[env:test_esp32]
platform = espressif32
board = esp32cam
framework = arduino
build_flags = 
    -std=gnu++17
    -DPXLCAM_TESTING
    -DPXLCAM_VERSION=\"1.2.0\"
build_unflags = -std=gnu++11
test_framework = unity
test_filter = test_v1_2
test_build_src = false

